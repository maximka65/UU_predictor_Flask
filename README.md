# Введение

Проект представляет собой аналитический сервис сайтов, базирующийся на данных из различных источников и применяющий машинное обучение для предсказания количества уникальных пользователей сайта.

Основные фичи, используемые для прогноза, включают общее количество посещений, среднее количество просмотренных страниц, процент посетителей, покидающих сайт после просмотра одной страницы, среднее время посещения, рейтинг Alexa и другие.

Мы разрабатываем и развертываем сервер Flask API, который обрабатывает GET-запросы в формате JSON с данными о сайте и возвращает прогнозы о количестве уникальных пользователей. Весь проект упакован в Docker для простоты и универсальности при развертывании.

Все процессы автоматизированы через GitLab CI/CD для непрерывной интеграции и доставки.

#### подробное описание в файле research.ipynb

## Декомпозиция задачи

Исследование:
1.1. Загрузка данных:
- Загрузка данных.
- Понимание структуры и формата данных.

1.2. Предварительная обработка данных:
- Перевод данных в нужный формат

1.3. Анализ данных:
- Описательная статистика.
- Корреляционный анализ для выявления связей между признаками.

1.4. Исследование моделей машинного обучения:
- Выбор подходящих моделей для тестирования.
- Проведение кросс-валидации и настройка гиперпараметров для каждой модели.
- Оценка эффективности каждой модели на основе метрик (например, MAE, MSE, RMSE).

1.5. Финальная валидация и сохранение модели:
- Проверка модели на тестовой выборке.
- Сохранение обученной модели для дальнейшего использования.
- Создание файла utils.py:

2.1. Разработка функций для обработки данных:
- Функция для чтения данных из исходного источника.
- Функции для предобработки данных (например, заполнение пропусков, удаление выбросов, преобразование типов данных).

2.2. Разработка функций для работы с моделью:
- Функция для загрузки обученной модели.
- Функция для предсказания на основе модели.
- Создание скрипта для дообучения:

3.1. Разработка функций для дообучения модели:
- Функция для загрузки новых данных.
- Функция для запуска процесса дообучения.
- Создание сервера Flask:

4.1. Разработка маршрутов API:
- Создание маршрута для получения прогнозов.
- Создание маршрута для дообучения модели.

4.2. Интеграция с обученной моделью:
- Загрузка обученной модели при запуске сервера.
- Обработка запросов и возврат прогнозов.
- Создание Dockerfile:

5.1. Определение базового образа.

5.2. Добавление инструкций для установки необходимых зависимостей.

5.3. Добавление инструкций для запуска сервера Flask.

Написание файла .gitlab-ci.yml:

6.1. Создание этапов CI/CD (например, сборка, тестирование, развертывание).

6.2. Определение задач для каждого этапа.

6.3. Добавление инструкций для автоматического развертывания приложения на сервере после коммита.


## Структура проекта

- data: Папка с входными данными для проекта.
- UU_predictor: Модуль, содержащий основной код для моделирования и предсказания уникальных пользователей.
    - flask_server.py: Сервер Flask, который служит API для модели.
    - model.py и model_train.py: Файлы, содержащие код для определения, обучения и сохранения модели.
    - requirements.txt: Список зависимостей Python проекта.
    - utils.py: Вспомогательные функции.
- research.ipynb: Jupyter Notebook для исследовательского анализа данных и прототипирования моделей.
- Dockerfile: Для создания Docker образа проекта.
- gitlab-ci.yml: Файл для CI/CD проекта через gitlab
- README.md: Описание проекта и инструкции по его установке и использованию.

## Запуск проекта

#### Локальный запуск
Для запуска проекта локально следуйте следующим шагам:

1. Клонируйте репозиторий в локальную директорию.

2. Установите все необходимые зависимости, указанные в requirements.txt. Это можно сделать, выполнив команду pip install -r requirements.txt.

3. Запустите сервер Flask, выполнив команду python flask_server.py.

После этого вы сможете отправлять POST-запросы серверу Flask в формате JSON. Пример входного запроса:

''' 
{
    "2018-12-01": {
        "alexa": null,
        "visits": 1000000,
        "pagesPerVisit": 5000000,
        "bounceRate": null,
        "avgVisitDuration": null,
        "category": 100
    }
}
'''

На этот запрос сервер ответит JSON-объектом с заполненным полем visits.

#### Деплой проекта
Для деплоя проекта вам нужно будет сделать push в ваш приватный репозиторий GitLab. Настройки в .yaml и Dockerfile автоматически развернут приложение на вашем сервере.

Обратите внимание, что из-за приватности репозитория этот процесс не может быть продемонстрирован здесь.

#### Обучение модели
Если у вас есть новые данные и необходимость дообучить модель, вы можете запустить скрипт model_train.py, предварительно изменив пути к новым файлам с данными.

После успешного обучения модели, она будет сохранена в папку проекта, готова к использованию сервером Flask.




